<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style type="text/css" rel="stylesheet">

    </style>
    <script src="https://hammerjs.github.io/dist/hammer.js"></script>
    <script src="//cdn.rawgit.com/hammerjs/touchemulator/0.0.2/touch-emulator.js"></script>
    <script> TouchEmulator(); </script>
</head>
<body>

<rotate-block id="rotate">
    <h2 style="text-align: center; color: white;">Press Shift+Click<br>and rotate</h2>
</rotate-block>


<script type="module">
  import {PinchGestureMixin} from '../src/PinchGestureMixin.js'; //test

  class RotateBlock extends PinchGestureMixin(HTMLElement) { //[1]

    constructor() {
      super();
      this._pinchStartListener = e => this._onPinchStart(e);
      this._pinchListener = e => this._onPinch(e);
      this._pinchEndListener = e => this._onPinchEnd(e);
    }

    static get dragFlingEventOrCallback() {
      return 1;
    }

    connectedCallback() {
      super.connectedCallback();
      this.addEventListener("pinchstart", this._pinchStartListener);
      this.style.display = "block";
      this.style.position = "fixed";
      this.style.left = "100px";
      this.style.top = "100px";
      this.style.width = "300px";
      this.style.height = "300px";
      this.style.background = "red";
    }


    disconnectedCallback() {
      super.disconnectedCallback();
      this.removeEventListener("pinchstart", this._pinchListener);
    }

    _onPinchStart(e) {
      this.addEventListener("pinch", this._pinchListener);
    }

    _onPinch(e) {
      this.addEventListener("pinchend", this._pinchEndListener);
      this.style.transform += `rotate(${e.detail.rotation}deg)`;
    }

    _onPinchEnd(e) {
      this.removeEventListener("pinch", this._pinchStartListener);
      this.removeEventListener("pinchend", this._pinchEndListener);
    }

    pinchCallback(pinchDetail) {
      this.style.transform += `rotate(${pinchDetail.rotation}deg)`;
    }
  }

  customElements.define("rotate-block", RotateBlock);

</script>
</body>
</html>
